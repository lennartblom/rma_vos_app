{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "Wecker"
    },
    "name": "MyController",
    "designerId": "a983e413-1f50-4b47-b18a-b92e8e18eab4",
    "cn": [
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "weckerBackButton",
                "selector": "button#weckerBackButton"
            },
            "name": "weckerBackButton",
            "designerId": "160ca1b9-dcd2-4e5f-baad-a6569ec71964"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "button#weckerBackButton",
                "designer|targetType": "Ext.Button",
                "fn": "weckerBackButton",
                "implHandler": [
                    "this.getWeckerView().hide();",
                    "this.getMainView().show();"
                ],
                "name": "tap"
            },
            "name": "weckerBackButton",
            "designerId": "9a0b9858-cd1a-4565-9f61-4ad7e00e2775"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "MainView",
                "selector": "container#MainView"
            },
            "name": "MainView",
            "designerId": "fdbfff51-3f59-43b0-a921-e95859660158"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "weckerView",
                "selector": "container#mycontainer1"
            },
            "name": "weckerView",
            "designerId": "3a280f06-082a-4e53-ba7d-7267ac91a42b"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "weckRadius",
                "selector": "sliderfield#weckRadius"
            },
            "name": "weckRadius",
            "designerId": "a3dad416-3c41-437a-9912-2a191985d5b7"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "sliderValueLabel",
                "selector": "label#sliderValueLabel"
            },
            "name": "sliderValueLabel",
            "designerId": "0dd17fb4-f434-4a24-a302-04ce6fbc0419"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "sliderfield#weckRadius",
                "designer|targetType": "Ext.field.Slider",
                "fn": "setWeckRadius",
                "implHandler": [
                    "Ext.getCmp('sliderValueLabel').setHtml(newValue+\" vor dem Zielpunkt\");",
                    "this.sliderValue = newValue;"
                ],
                "name": "change"
            },
            "name": "setWeckRadius",
            "designerId": "e74452d1-adb6-4c40-91f1-12266b233aa4"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "sliderfield#weckRadius",
                "designer|targetType": "Ext.field.Slider",
                "fn": "onSliderfieldDrag",
                "implHandler": [
                    "var slider = sliderfield.getComponent();",
                    "var label = Ext.getCmp('sliderValueLabel');",
                    "label.setHtml(slider.getValue()+\"m vor dem Zielpunkt\");",
                    "this.sliderValue = slider.getValue();"
                ],
                "name": "drag"
            },
            "name": "onSliderfieldDrag",
            "designerId": "06b3bd79-2abd-43d7-a29e-c4bfe792174b"
        },
        {
            "type": "fixedfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "application"
                ],
                "fn": "init",
                "implHandler": [
                    "this.sliderValue = 200;",
                    "this.weckerIsOn = false;",
                    "this.shortestPath = true;",
                    "this.weckerKlingeltMehrfach=false;",
                    "this.tune = \"superMario.mp3\";",
                    "this.geo = null;",
                    "this.lat = 0.0;",
                    "this.lng = 0.0;",
                    "this.trackingId = 0;",
                    "this.activeInterval=0;",
                    "this.bgGeo=null;"
                ]
            },
            "name": "init",
            "designerId": "2b03c1d5-c1cc-4b1b-a16a-b3db4ec100e3"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "weckerOnOffSwitch",
                "selector": "togglefield#weckerOnOffSwitch"
            },
            "name": "weckerOnOffSwitch",
            "designerId": "83f12b91-1c87-4558-ab22-dec83cb30791"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "selectTune",
                "selector": "selectfield#selectTune"
            },
            "name": "selectTune",
            "designerId": "20a5c0c2-5b93-4cae-8df3-5b473ac54b4b"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "shortestPath",
                "selector": "checkboxfield#shortestPath"
            },
            "name": "shortestPath",
            "designerId": "e10aacb2-ce32-4a46-a1aa-876d0b18d6b5"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "mehrfachKlingelnOnOffSwitch",
                "selector": "togglefield#mehrfachKlingelnOnOffSwitch"
            },
            "name": "mehrfachKlingelnOnOffSwitch",
            "designerId": "f51d98ae-c6b6-442f-a8d3-97c1e8d5b9c0"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "togglefield",
                "designer|targetType": "Ext.field.Toggle",
                "fn": "onTogglefieldChange",
                "implHandler": [
                    "this.weckerIsOn=newValue;",
                    "console.log(\"Toggle Field value: \"+newValue);",
                    "this.getGeo(newValue);"
                ],
                "name": "change"
            },
            "name": "onTogglefieldChange",
            "designerId": "b78c47aa-e429-403c-bd38-d6a662e7648c"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "selectfield",
                "designer|targetType": "Ext.field.Select",
                "fn": "onSelectfieldChange",
                "implHandler": [
                    "this.tune = newValue;"
                ],
                "name": "change"
            },
            "name": "onSelectfieldChange",
            "designerId": "fc26925e-ad75-4530-985d-996fa028860c"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "wecken",
                "implHandler": [
                    "navigator.vibrate(1);",
                    "var resource = \"resources/tones/\" + this.tune;",
                    "navigator.vibrate(1);",
                    "var myMedia = new Media(resource);",
                    "navigator.vibrate(1);",
                    "myMedia.play();",
                    "navigator.vibrate(1);",
                    "navigator.notification.alert(\"Sie haben den Ziel Ort erreicht, oder befinden sich in unmitelbarer NÃ¤he\",function(){myMedia.stop();},\"Zielort Erreicht!\");",
                    "navigator.vibrate(1);"
                ]
            },
            "name": "wecken",
            "designerId": "80917b31-04d4-497e-9e12-2f5163310ecb"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "isTracking"
                ],
                "fn": "getGeo",
                "implHandler": [
                    "var pace = this.getApplication().getController('Settings').sliderPace;",
                    "",
                    "if(isTracking){",
                    "    console.log(\"device is tracking\");",
                    "    this.saveGeo(pace*1000);",
                    "    this.setupBackgroundPace();",
                    "}else{",
                    "    clearInterval(this.activeInterval);",
                    "    this.bgGeo.stop();",
                    "       console.log(\"pace disabled\");",
                    "",
                    "}"
                ]
            },
            "name": "getGeo",
            "designerId": "d88c41a1-f8e9-4ad9-ac6e-cc82ce8bb391"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "interval"
                ],
                "fn": "resetGeoTimer",
                "implHandler": [
                    "if(this.weckerIsOn){",
                    "    clearInterval(this.activeInterval);",
                    "    this.saveGeo(interval*1000);",
                    "}"
                ]
            },
            "name": "resetGeoTimer",
            "designerId": "b51606a9-f243-415a-997c-a233c5cbc4a8"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "interval"
                ],
                "fn": "saveGeo",
                "implHandler": [
                    "var geoCallback = function(position){",
                    "            console.log(position.coords.latitude);",
                    "            console.log(position.coords.longitude);",
                    "            console.log('[JS] Koordinaten: '+position.coords.latitude+",
                    "                ' '+position.coords.longitude);",
                    "        };",
                    "var geoError = function(error){",
                    "                console.log(\"error while paceing\");",
                    "};",
                    "console.log(\"saveGeo wurde aufgerufen.\");",
                    "function getGeoObject(){ navigator.geolocation.getCurrentPosition(",
                    "        geoCallback,",
                    "        geoError,",
                    "        {",
                    "            enableHighAccuracy: true",
                    "        });",
                    "}",
                    "this.activeInterval = setInterval(getGeoObject,interval);"
                ]
            },
            "name": "saveGeo",
            "designerId": "01fb4c26-0acf-45a9-a492-ca0c192e948c"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "setupBackgroundPace",
                "implHandler": [
                    "        window.navigator.geolocation.getCurrentPosition(function(location) {",
                    "            console.log(\"background init: \"+location.coords.latitude + \" \"+ location.coords.longitude);",
                    "            this.lat=location.coords.latitude;",
                    "            this.lng=location.coords.longitude;",
                    "        });",
                    "",
                    "       var bgGeo  = window.plugins.backgroundGeoLocation;",
                    "",
                    "        /**",
                    "        * This would be your own callback for Ajax-requests after POSTing background geolocation to your server.",
                    "        */",
                    "        var yourAjaxCallback = function(response) {",
                    "            console.log(\"ajaxCallBack\");",
                    "            ////",
                    "            // IMPORTANT:  You must execute the #finish method here to inform the native plugin that you're finished,",
                    "            //  and the background-task may be completed.  You must do this regardless if your HTTP request is successful or not.",
                    "            // IF YOU DON'T, ios will CRASH YOUR APP for spending too much time in the background.",
                    "            //",
                    "            //",
                    "            bgGeo.finish();",
                    "        };",
                    "",
                    "        /**",
                    "        * This callback will be executed every time a geolocation is recorded in the background.",
                    "        */",
                    "        var callbackFn = function(location) {",
                    "            console.log(\"background track: \"+location.latitude + \" \"+ location.longitude);",
                    "            this.lat=location.latitude;",
                    "            this.lng=location.longitude;",
                    "            //navigator.notification.alert(\"Aktuelle Position: \"+this.lat+\" \"+this.lng,\"Alert\");",
                    "            // Do your HTTP request here to POST location to your server.",
                    "            //",
                    "            //",
                    "            yourAjaxCallback.call(this);",
                    "        };",
                    "",
                    "        var failureFn = function(error) {",
                    "            console.log('BackgroundGeoLocation error');",
                    "        };",
                    "",
                    "        // BackgroundGeoLocation is highly configurable.",
                    "        bgGeo.configure(callbackFn, failureFn, {",
                    "            locationTimeout: 5,",
                    "            desiredAccuracy: 10,",
                    "            stationaryRadius: 10,",
                    "            distanceFilter: 10,",
                    "            activityType: \"Fitness\",",
                    "            stopOnTerminate: false,// <-- iOS-only",
                    "            debug: false     // <-- enable this hear sounds for background-geolocation life-cycle.",
                    "        });",
                    "",
                    "        // Turn ON the background-geolocation system.  The user will be tracked whenever they suspend the app.",
                    "        bgGeo.start();",
                    "        //bgGeo.changePace(true);",
                    "        this.bgGeo = bgGeo;",
                    "        // If you wish to turn OFF background-tracking, call the #stop method.",
                    "        // bgGeo.stop()"
                ]
            },
            "name": "setupBackgroundPace",
            "designerId": "07fd1fb5-1f75-44af-9361-7a7b9011efad"
        }
    ]
}